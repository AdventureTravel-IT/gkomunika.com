{% style %}
  body {
    max-width: 1920px;
    margin: 0 auto;
  }
  .ma-link {
    width: 100%;
    text-decoration: none;
  }
  .ma-container {
    display: flex;
    width: 100%;
    height: 100%;
    padding: 20px 10%;
    gap: 20px;
    overflow: hidden;
  }
  .ma-section-menu {
    width: 330px;
    height: 100%;
    display: flex;
    flex-direction: column;
    gap: 15px;
  }
  .ma-menu-wrapper {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 15px;
    border-radius: 15px;
    border: none;
    background-color: var(--color-neutral);
    gap: 5px;
    cursor: pointer;
  }
  .menu-wrapper {
    display: flex;
    gap: 10px;
    align-items: center;
  }
  .menu-wrapper.active img {
    content: url('{{ 'profile.svg' | asset_url }}');
  }

  .ma-menu-wrapper img {
    filter: brightness(0) saturate(100%) invert(22%) sepia(58%) saturate(2396%) hue-rotate(188deg) brightness(93%)
      contrast(101%);
  }
  .menu-wrapper:hover {
    filter: brightness(0) saturate(100%) invert(80%) sepia(63%) saturate(5712%) hue-rotate(158deg) brightness(89%)
      contrast(111%);
  }

  .ma-menu-wrapper .menu-wrapper.active h2 {
    color: var(--color-secondary);
  }

  .ma-menu-wrapper .menu-wrapper.active img {
    filter: brightness(0) saturate(100%) invert(80%) sepia(63%) saturate(5712%) hue-rotate(158deg) brightness(89%)
      contrast(111%);
  }
  .ma-menu-wrapper h2 {
    margin: 0;
    line-height: 1.2;
    color: var(--color-primary);
    font-size: var(--font-large);
    font-weight: bold;
  }
  .ma-menu-username {
    align-items: center;
    justify-content: center;
    text-align: center;
  }
  .ma-menu-username h2,
  p {
    margin: 0;
  }
  .ma-menu-username h2 {
    color: var(--color-primary);
    font-weight: bold;
  }
  .ma-menu-username p {
    color: var(--color-secondary);
  }
  .ma-menu-wrapper.membership {
    display: flex;
    justify-content: space-between;
    padding: 10px;
  }
  .ma-membership-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    border-radius: 10px;
    padding: 5px;
    gap: 5px;
    background-color: var(--color-primary);
    color: var(--color-neutral);
    border: none;
  }
  .ma-membership-btn p {
    font-size: var(--font-small);
    margin: 0;
  }
  .ma-section-order-history {
    width: 100%;
    display: flex;
    flex-direction: column;
    gap: 20px;
  }
  .ma-section-order-history-wrapper {
    display: flex;
    flex-direction: column;
    border-radius: 15px;
    gap: 15px;
  }
  #ma-section-order-history-wrapper {
    display: flex;
    flex-direction: column;
    background-color: var(--color-neutral);
    border-radius: 15px;
    gap: 15px;
    padding: 10px;
  }
  .ma-order-history-wrapper {
    width: 100%;
    display: flex;
    justify-content: space-between;
  }
  .ma-order-history-wrapper h2,
  .ma-order-history-invoice p {
    margin: 0;
    font-size: var(--font-large);
    color: var(--color-primary);
  }
  .ma-order-history-invoice {
    display: flex;
    gap: 5px;
    flex: 1;
    align-items: center;
  }
  .ma-product-icon-single-flag {
    border-radius: 10px;
    border: 1px solid #d9d9d9;
  }
  .ma-product-multi-flag {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    height: 100%;
    gap: 1px;
    justify-content: center;
    align-items: center;
  }
  .ma-product-icon-multi-flag {
    border-radius: 5px;
    border: 1px solid var(--color-border);
  }
  .ma-product-flag-count {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 25px;
    height: 25px;
    border: 1px solid #d9d9d9;
    border-radius: 5px;
    color: var(--color-primary);
    background-color: white;
  }
  .ma-product-flag-count span {
    color: var(--color-primary);
    font-weight: bold;
    font-size: var(--font-small);
  }
  .ma-product-wrapper {
    display: flex;
    gap: 10px;
  }
  .ma-product-wrapper h2 {
    margin: 0;
    line-height: 1;
  }
  .ma-order-product-name h2 {
    line-height: 1;
    font-size: var(--font-extra-large);
    color: var(--color-primary);
    font-weight: bold;
  }
  .ma-order-product-name p {
    text-align: top;
    font-size: var(--font-small);
    color: var(--color-secondary);
  }
  .ma-order-quantity {
    display: flex;
    flex-direction: column;
    gap: 3px;
  }
  .ma-order-quantity p {
    margin: 0;
    line-height: 1;
    color: var(--color-primary);
    font-weight: bold;
    text-align: right;
    font-size: var(--font-large);
  }
  .ma-order-total p {
    color: var(--color-primary);
    font-size: var(--font-small);
  }
  .ma-order-total h2 {
    color: var(--color-primary);
    font-weight: bold;
  }
  .ma-order-button .write,
  .ma-order-button .details {
    border-radius: 15px;
    border: none;
    color: var(--color-neutral);
    font-size: var(--font-large);
    font-weight: bold;
    padding: 10px;
  }
  .ma-order-button .write {
    background-color: var(--color-secondary);
  }
  .ma-order-button .details {
    background-color: var(--color-primary);
  }
  .ma-order-redeem {
    display: flex;
    flex-direction: column;
    width: 100%;
  }
  .ma-section-order-history-container {
    width: 100%;
  }
  .ma-back-button {
    display: none;
    background-color: var(--color-primary);
    color: white;
    padding: 10px 15px;
    border: none;
    border-radius: 10px;
    margin-bottom: 10px;
    margin-top: 10px;
    font-weight: bold;
    cursor: pointer;
  }
  .ma-back-button.show {
    display: block;
  }
  .mobile-hidden {
    display: none !important;
  }
  .hidden {
    display: none;
  }

  .ma-menu-wrapper.active {
    color: var(--color-secondary);
  }
  .ma-menu-wrapper.active .menu-wrapper {
    filter: brightness(0) saturate(100%) invert(80%) sepia(63%) saturate(5712%) hue-rotate(158deg) brightness(89%)
      contrast(111%);
  }
  .ma-menu-wrapper.active h2 {
    color: var(--color-neutral);
  }

  @media (max-width: 768px) {
    .ma-container {
      padding: 20px 24px;
      display: flex;
      flex-direction: column;
    }
    .ma-section-menu {
      display: block;
      width: 100%;
    }
    .ma-menu-username {
      margin-bottom: 50px;
    }
    .ma-menu-wrapper {
      margin-top: 10px;
      width: 100%;
    }
    .ma-order-product-name h2,
    .ma-order-product-name p {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 100px;
    }
    .ma-order-button {
      display: flex;
      gap: 5px;
      align-items: center;
    }
    .ma-order-button .write {
      background-color: var(--color-secondary);
    }
    .ma-order-button .details {
      background-color: var(--color-primary);
    }
    .ma-order-button button {
      white-space: nowrap;
      padding: 10px 15px;
      width: auto;
      min-width: max-content;
      display: inline-block;
      text-align: center;
      height: 100%;
      max-height: 35px;
    }
  }
{% endstyle %}

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const tabButtons = document.querySelectorAll('.ma-menu-wrapper[data-tab]');
    const tabContents = {
      'order-history': document.getElementById('order-history'),
      'edit-profile': document.getElementById('edit-profile'),
      membership: document.getElementById('membership'),
      referral: document.getElementById('referral'),
    };

    const menuSection = document.querySelector('.ma-section-menu');
    const backToMenuBtn = document.getElementById('back-to-menu');

    function hideAllTabs() {
      Object.values(tabContents).forEach((section) => {
        if (section) {
          section.classList.add('hidden');
        }
      });
    }

    function showMenu() {
      menuSection.classList.remove('mobile-hidden');
      if (backToMenuBtn) {
        backToMenuBtn.classList.remove('show');
      }
      tabButtons.forEach((btn) => btn.classList.remove('active'));
      hideAllTabs();
    }

    // Initial load
    if (window.innerWidth <= 768) {
      hideAllTabs();
      tabButtons.forEach((btn) => btn.classList.remove('active'));
    } else {
      hideAllTabs();
      if (tabContents['order-history']) {
        tabContents['order-history'].classList.remove('hidden');
      }
      const orderBtn = document.querySelector('.ma-menu-wrapper[data-tab="order-history"]');
      if (orderBtn) {
        orderBtn.classList.add('active');
      }
    }

    tabButtons.forEach((button) => {
      button.addEventListener('click', () => {
        const selectedTab = button.getAttribute('data-tab');

        tabButtons.forEach((btn) => btn.classList.remove('active'));
        button.classList.add('active');

        hideAllTabs();
        if (tabContents[selectedTab]) {
          tabContents[selectedTab].classList.remove('hidden');
        }

        if (window.innerWidth <= 768) {
          menuSection.classList.add('mobile-hidden');
          if (backToMenuBtn) {
            backToMenuBtn.classList.add('show');
          }
        }
      });
    });

    if (backToMenuBtn) {
      backToMenuBtn.addEventListener('click', () => {
        showMenu();

        window.scrollTo({
          top: 0,
          behavior: 'smooth',
        });
      });
    }
  });
</script>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const urlParams = new URLSearchParams(window.location.search);
    const pageParam = urlParams.get('page');

    const isMobile = window.innerWidth <= 768;

    if (pageParam && isMobile) {
      const menuSection = document.querySelector('.ma-section-menu');
      const targetSection = document.getElementById(pageParam);
      const backToMenuBtn = document.getElementById('back-to-menu');

      if (menuSection) {
        menuSection.classList.add('mobile-hidden');
      }

      if (targetSection) {
        targetSection.classList.remove('hidden');
      }

      if (backToMenuBtn) {
        backToMenuBtn.classList.add('show');
      }

      const tabButtons = document.querySelectorAll('.ma-menu-wrapper[data-tab]');
      tabButtons.forEach((btn) => {
        btn.classList.toggle('active', btn.getAttribute('data-tab') === pageParam);
      });
    }
  });
</script>

<div class="ma-container">
  <section class="ma-section-menu">
    {% render 'menu-main-account' %}
  </section>

  <section class="ma-section-order-history-container">
    <div id="order-history" class="hidden">{% render 'order-history' %}</div>
    <div id="edit-profile" class="hidden">{% render 'edit-profile' %}</div>
    <div id="membership" class="hidden">{% render 'membership' %}</div>
    <button id="back-to-menu" class="ma-back-button">Back</button>
    {% comment %} <div id="referral" class="hidden">{% render 'referral' %}</div> {% endcomment %}
  </section>
</div>

{% schema %}
{
  "name": "t:sections.main-account.name",
  "settings": [
    {
      "type": "header",
      "content": "t:sections.all.padding.section_padding_heading"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_top",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 36
    }
  ]
}
{% endschema %}
