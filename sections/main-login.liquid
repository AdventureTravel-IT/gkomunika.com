<style>
  .login {
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 0 auto;
    max-width: 1920px;
    height: 100 dvh;
  }

  .MainLogin-container {
    width: 350px;
    height: auto;
    padding: 10px;
  }

  .MainLogin-logo {
    display: flex;
    justify-content: center;
    padding: 15px;
  }

  .MainLogin-Tabs {
    display: flex;
    width: 100%;
    height: auto;
  }

  .MainLogin-TabButton {
    flex: 1;
    padding: 15px;
    background: transparent;
    color: var(--color-primary);
    border: none;
    outline: none;
    cursor: pointer;
    font-size: var(--font-large);
    font-weight: bold;
    transition: background-color 0.2s ease;
    border-radius: 15px 15px 0 0;
    text-align: center;
    text-decoration: none;
  }

  .MainLogin-TabButton.active {
    background-color: var(--color-neutral);
  }

  .MainLogin-form {
    display: flex;
    padding: 20px;
    background-color: var(--color-neutral);
    border-radius: 0 15px 15px 15px;
    transition: border-radius 0.3s ease;
  }

  .FormLogin,
  .FormRecover {
    display: none;
    width: 100%;
  }

  .FormLogin.active,
  .FormRecover.active {
    display: block;
  }

  .wrapper-field {
    display: flex;
    gap: 10px;
  }

  .field-auth {
    margin-bottom: 15px;
    color: var(--color-primary);
  }

  .field-auth input {
    display: flex;
    width: 100%;
    padding: 15px;
    color: var(--color-primary);
    background-color: var(--color-background-secondary);
    border: none;
    outline: none;
    border-radius: 10px;
    font-size: var(--font-large);
  }

  .field-auth input.invalid,
  .field-auth input[aria-invalid='true'] {
    border: 1px solid red !important;
  }

  .field-auth input::placeholder {
    color: var(--color-primary);
  }

  .WrapperButton-form {
    display: flex;
    flex-direction: column;
    width: 100%;
    justify-content: left;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .WrapperButton-form .link-recover {
    display: inline !important;
    width: auto !important;
    padding: 0 !important;
    margin: 0 0 15px 0;
    background: transparent;
    border: none;
    color: var(--color-primary);
    text-decoration: underline;
    text-decoration-color: var(--color-primary);
    text-underline-offset: 2px;
    cursor: pointer;
  }

  .WrapperButton-form a {
    min-width: 0;
    color: var(--color-primary);
    margin-bottom: 15px;
    text-align: left;
  }

  .button-form {
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    min-width: 120px;
    padding: 12px 16px;
    border: none;
    border-radius: 10px;
    background-color: var(--color-primary);
    color: var(--color-neutral);
    font-size: var(--font-large);
    font-weight: 600;
    cursor: pointer;
  }

  .button-form:disabled {
    background-color: #ccc;
    color: #666;
    cursor: not-allowed;
  }

  .button-form:active {
    transform: scale(0.96);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  }

  .form-error-message {
    background: #ffebee;
    padding: 10px 15px;
    border-radius: 5px;
    margin-bottom: 15px;
    font-size: 14px;
    color: red;
    text-align: center;
  }

  .field-error-message {
    color: red;
    font-size: 12px;
    margin-top: 5px;
    display: block;
  }

  .field-auth input:-webkit-autofill {
    -webkit-text-fill-color: var(--color-primary);
    transition: background-color 9999s ease-in-out 0s;
    caret-color: var(--color-primary);
  }

  .field-auth input:autofill {
    color: var(--color-neutral);
  }

  .custom-auth-divider {
    display: flex;
    align-items: center;
    text-align: center;
    margin: 15px 0;
  }

  .custom-auth-divider::before,
  .custom-auth-divider::after {
    content: '';
    flex: 1;
    border-bottom: 1px solid #005496;
    margin: 0 10px;
  }

  .custom-auth-divider span {
    font-size: 14px;
    color: #005496;
  }

  @media (max-width: 768px) {
    .MainLogin-container {
      padding: 0 24px;
    }
  }
</style>

<div class="login">
  <div class="MainLogin-container">
    <section class="MainLogin-logo">
      {% if section.settings.logo != blank %}
        <a href="/">
          <img
            class="footer__logo"
            src="{{ section.settings.logo | img_url: 'master' }}"
            width="auto"
            height="80"
            alt="Site Logo"
          >
        </a>
      {% endif %}
    </section>

    <section class="MainLogin-Tabs" id="MainLogin-Tabs">
      <a class="MainLogin-TabButton active" href="/account/login">Login</a>
      <a class="MainLogin-TabButton" href="/account/register">Register</a>
    </section>

    <section class="MainLogin-form">
      <div
        class="FormSuccess"
        id="FormSuccess"
        style="display: none;"
      >
        <div class="recovery-popup">
          <p style="color: var(--color-primary); margin: 0 0 10px 0;">
            Your password reset link has been sent to your email.
            <span id="recovery-email"></span>
          </p>
          <div class="WrapperButton-form">
            <button
              type="button"
              class="button-form"
              id="go-to-login"
            >
              Go to Login
            </button>
          </div>
        </div>
      </div>

      <div class="FormLogin active" id="FormLogin">
        {%- form 'customer_login', novalidate: 'novalidate', return_to: '/' -%}
          {% if form.errors %}
            <div class="form-error-message">Incorrect email or password. Please try again.</div>
          {% endif %}

          <div class="field-auth">
            <input
              type="email"
              name="customer[email]"
              id="Login-Email"
              placeholder="Email"
              value="{{ form.email }}"
              required
              {% if form.errors %}
                aria-invalid="true"
              {% endif %}
            >
            <span class="field-error-message" id="LoginEmailError"></span>
          </div>

          <div class="field-auth">
            <input
              type="password"
              name="customer[password]"
              id="Login-Password"
              placeholder="Password"
              required
              {% if form.errors %}
                aria-invalid="true"
              {% endif %}
            >
            <span class="field-error-message" id="LoginPasswordError"></span>
          </div>

          <div class="WrapperButton-form">
            <a
              href="javascript:void(0)"
              class="link-recover"
              onclick="showRecoveryForm()"
              >Forgot Password?</a
            >
            <button
              class="button-form"
              id="login-button"
              type="button"
            >
              <span class="login-button-text">Log In</span>
            </button>
          </div>

          <div class="custom-auth-divider">
            <span>or</span>
          </div>

          <div class="oxi-social-login" style="margin-top: 15px"></div>
        {%- endform -%}
      </div>

      <div class="FormRecover" id="FormRecovery">
        {% render 'form-recovery' %}
      </div>
    </section>
  </div>
</div>

<script>
  function showRecoveryForm() {
    document.querySelectorAll('.MainLogin-form > div').forEach((form) => {
      form.classList.remove('active');
    });
    document.getElementById('FormRecovery').classList.add('active');
    document.querySelector('.MainLogin-Tabs').style.display = 'none';
  }

  document.addEventListener('DOMContentLoaded', function () {
    if (sessionStorage.getItem('login') === 'true') {
      document.querySelectorAll('.MainLogin-form > div').forEach((form) => {
        form.style.display = 'none';
      });
      document.querySelector('.MainLogin-Tabs').style.display = 'none';
      document.getElementById('FormSuccess').style.display = 'block';
    }

    const btn = document.getElementById('go-to-login');
    if (btn) {
      btn.addEventListener('click', function () {
        sessionStorage.removeItem('login');
        window.location.href = '/account/login';
      });
    }

    const loginForm = document.querySelector('#FormLogin form');
    const loginButton = document.getElementById('login-button');

    if (loginForm && loginButton) {
      loginButton.addEventListener('click', function () {
        if (loginButton.disabled) return;

        const email = document.getElementById('Login-Email');
        const password = document.getElementById('Login-Password');
        const emailError = document.getElementById('LoginEmailError');
        const passwordError = document.getElementById('LoginPasswordError');

        emailError.textContent = '';
        passwordError.textContent = '';

        let hasError = false;

        if (!email.value.trim()) {
          emailError.textContent = 'Email is required.';
          hasError = true;
        }

        if (!password.value.trim()) {
          passwordError.textContent = 'Password is required.';
          hasError = true;
        }

        if (hasError) return;

        loginButton.disabled = true;
        loginButton.querySelector('.login-button-text').textContent = 'Logging in...';

        loginForm.submit();
      });
    }
  });
</script>

{% schema %}
{
  "name": "main login",
  "settings": [
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Insert Logo"
    }
  ]
}
{% endschema %}
