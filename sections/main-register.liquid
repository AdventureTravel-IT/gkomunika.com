<style>
  .register {
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 0 auto;
    max-width: 1920px;
    height: 100 dv h;
  }

  .MainRegister-container {
    width: 350px;
    height: auto;
    padding: 10px;
  }

  .MainRegister-logo {
    display: flex;
    justify-content: center;
    padding: 15px;
  }

  .MainRegister-Tabs {
    display: flex;
    width: 100%;
    height: auto;
  }

  .MainRegister-TabButton {
    flex: 1;
    padding: 15px;
    background: transparent;
    color: var(--color-primary);
    border: none;
    outline: none;
    cursor: pointer;
    font-size: var(--font-large);
    font-weight: bold;
    transition: background-color 0.2s ease;
    border-radius: 15px 15px 0 0;
    text-align: center;
    text-decoration: none;
  }

  .MainRegister-TabButton.active {
    background-color: var(--color-neutral);
  }

  .MainRegister-form {
    display: flex;
    padding: 20px;
    background-color: var(--color-neutral);
    border-radius: 0 15px 15px 15px;
    transition: border-radius 0.3s ease;
  }

  /* Hanya pakai FormRegister di file ini */
  .FormRegister {
    display: none;
    width: 100%;
  }

  .FormRegister.active {
    display: block;
  }

  .wrapper-field {
    display: flex;
    gap: 10px;
  }

  .field-auth {
    margin-bottom: 15px;
    color: var(--color-primary);
  }

  .field-auth input {
    display: flex;
    width: 100%;
    padding: 15px;
    color: var(--color-primary);
    background-color: var(--color-background-secondary);
    border: none;
    outline: none;
    border-radius: 10px;
    font-size: var(--font-large);
  }

  .field-auth input.invalid,
  .field-auth input[aria-invalid='true'] {
    border: 1px solid red !important;
  }

  .field-auth input::placeholder {
    color: var(--color-primary);
  }

  .WrapperButton-form {
    display: flex;
    flex-direction: column;
    width: 100%;
    justify-content: left;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    cursor: pointer;
  }

  .WrapperButton-form a {
    min-width: 0;
    color: var(--color-primary);
    margin-bottom: 15px;
    text-align: left;
  }

  .button-form {
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    min-width: 120px;
    padding: 12px 16px;
    border: none;
    border-radius: 10px;
    background-color: var(--color-primary);
    color: var(--color-neutral);
    font-size: var(--font-large);
    font-weight: 600;
    cursor: pointer;
  }

  .button-form:disabled {
    background-color: #ccc;
    color: #666;
    cursor: not-allowed;
  }

  .button-form:active {
    transform: scale(0.96);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  }

  .form-error-message {
    background: #ffebee;
    padding: 10px 15px;
    border-radius: 5px;
    margin-bottom: 15px;
    font-size: 14px;
    color: red;
    text-align: center;
  }

  .form-error-message ul {
    list-style: none;
    margin: 0;
    padding: 0;
  }

  .form-error-message a {
    color: inherit;
    text-decoration: underline;
  }

  .email-error-message {
    color: red;
    font-size: 12px;
    margin-top: 5px;
    display: none;
  }

  .password-strength-message {
    font-size: 12px;
    margin-top: 5px;
  }

  .terms-checkbox {
    display: flex;
    align-items: center;
    margin: 15px 0;
    font-size: 12px;
  }

  .terms-checkbox input {
    width: auto !important;
    margin-right: 10px;
  }

  .terms-checkbox a {
    color: var(--color-primary);
  }

  .field-error-message {
    color: red;
    font-size: 12px;
    margin-top: 5px;
    display: block;
  }

  .field-auth input:-webkit-autofill {
    -webkit-text-fill-color: var(--color-primary);
    transition: background-color 9999s ease-in-out 0s;
    caret-color: var(--color-primary);
  }

  .field-auth input:autofill {
    color: var(--color-neutral);
  }

  .custom-auth-divider {
    display: flex;
    align-items: center;
    text-align: center;
    margin: 15px 0;
  }

  .custom-auth-divider::before,
  .custom-auth-divider::after {
    content: '';
    flex: 1;
    border-bottom: 1px solid #005496;
    margin: 0 10px;
  }

  .custom-auth-divider span {
    font-size: 14px;
    color: #005496;
  }

  @media (max-width: 768px) {
    .MainRegister-container {
      padding: 0 24px;
    }
  }
</style>

<div class="register">
  <div class="MainRegister-container">
    <section class="MainRegister-logo">
      {% if section.settings.logo != blank %}
        <a href="/">
          <img
            class="footer__logo"
            src="{{ section.settings.logo | img_url: 'master' }}"
            width="auto"
            height="80"
            alt="Site Logo"
          >
        </a>
      {% endif %}
    </section>

    <section class="MainRegister-Tabs" id="MainRegister-Tabs">
      <a class="MainRegister-TabButton" href="/account/login">Login</a>
      <a class="MainRegister-TabButton active" href="/account/register">Register</a>
    </section>

    <section class="MainRegister-form">
      <div class="FormRegister active" id="FormRegister">
        {%- form 'create_customer', novalidate: 'novalidate', class: 'customer-register-form' -%}
          {% if form.errors %}
            {%- assign err_text = form.errors | default_errors -%}
            <div class="form-error-message">
              {%- if err_text contains 'associated with an account' or err_text contains 'already associated' -%}
                This email address is already associated with an account. <br>
                You may
                <a href="/account/login" style="color:inherit; text-decoration:underline;">login directly</a>.
              {%- else -%}
                {{ err_text | strip_html }}
              {%- endif -%}
            </div>
          {%- endif -%}

          <div class="field-auth">
            <input
              type="email"
              name="customer[email]"
              id="RegisterForm-email"
              placeholder="Email"
              required
              value="{{ form.email }}"
              onblur="validateEmail(this)"
              {% if form.errors contains 'email' %}
                aria-invalid="true"
              {% endif %}
            >
            <span class="email-error-message">Invalid email format</span>
          </div>

          <div class="field-auth">
            <input
              type="password"
              name="customer[password]"
              id="RegisterForm-password"
              placeholder="Password"
              required
              minlength="8"
            >
            <span class="password-strength-message"></span>
            <span class="field-error-message" id="RegisterPasswordError"></span>
          </div>

          <div class="field-auth terms-checkbox">
            <input
              type="checkbox"
              id="terms-checkbox"
              name="terms"
              required
            >
            <label for="terms-checkbox">
              I agree
              <a href="/pages/terms-of-use" target="_blank">Terms & Conditions</a>
            </label>
          </div>
          <span class="field-error-message" id="RegisterTermsError"></span>

          <div class="WrapperButton-form">
            <button
              class="button-form"
              id="register-button"
              type="button"
              disabled
            >
              Register
            </button>
          </div>

          <div class="custom-auth-divider">
            <span>or</span>
          </div>
        {%- endform -%}
      </div>
    </section>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const registerForm = document.querySelector('.customer-register-form');
    const registerButton = document.getElementById('register-button');

    if (!registerForm || !registerButton) return;

    const emailInput = document.getElementById('RegisterForm-email');
    const passwordInput = document.getElementById('RegisterForm-password');
    const termsCheckbox = document.getElementById('terms-checkbox');

    const emailError = document.querySelector('.email-error-message');
    const passwordError = document.getElementById('RegisterPasswordError');
    const termsError = document.getElementById('RegisterTermsError');

    if (termsCheckbox) {
      registerButton.disabled = !termsCheckbox.checked;
      termsCheckbox.addEventListener('change', function () {
        registerButton.disabled = !this.checked;
      });
    }

    registerButton.addEventListener('click', function () {
      if (registerButton.disabled) return;

      passwordError.textContent = '';
      termsError.textContent = '';
      if (emailError) {
        emailError.style.display = 'none';
        emailError.textContent = 'Invalid email format';
      }

      let hasError = false;

      if (!emailInput.value.trim()) {
        if (emailError) {
          emailError.textContent = 'Email is required.';
          emailError.style.display = 'block';
        }
        hasError = true;
      } else if (!validateEmail(emailInput)) {
        if (emailError) {
          emailError.textContent = 'Invalid email format';
          emailError.style.display = 'block';
        }
        hasError = true;
      }

      if (!passwordInput.value.trim()) {
        passwordError.textContent = 'Password is required.';
        hasError = true;
      } else if (passwordInput.value.length < 8) {
        passwordError.textContent = 'Password must be at least 8 characters.';
        hasError = true;
      }

      if (!termsCheckbox.checked) {
        termsError.textContent = 'Please accept the terms and conditions.';
        hasError = true;
      }

      if (hasError) return;

      registerButton.disabled = true;
      registerButton.textContent = 'Registering...';

      registerForm.submit();
    });
  });

  function validateEmail(input) {
    const pattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return pattern.test(input.value);
  }
</script>

{% schema %}
{
  "name": "t:sections.main-register.name",
  "settings": [
    {
      "type": "header",
      "content": "t:sections.all.padding.section_padding_heading"
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Insert Logo"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_top",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 36
    }
  ]
}
{% endschema %}
