<style>
  .disclosure__button .collapse-icon {
    display: inline-flex;
    transition: transform 0.2s ease;
  }

  .disclosure__button[aria-expanded="true"] .collapse-icon {
    transform: rotate(-180deg);
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.disclosure__button').forEach(function(button) {
      button.addEventListener('click', function() {
        var expanded = button.getAttribute('aria-expanded') === 'true';
        button.setAttribute('aria-expanded', String(!expanded));

        // Optional: sekalian toggle list-nya
        var wrapper = button.parentElement.querySelector('.disclosure__list-wrapper');
        if (wrapper) {
          wrapper.hidden = expanded; // kalau tadinya terbuka, sekarang disembunyikan
        }
      });
    });
  });
</script>


<div class="disclosure">
  <button
    type="button"
    class="disclosure__button localization-form__select localization-selector link link--text caption-large"
    aria-expanded="false"
    aria-controls="{{ localPosition }}List"
    aria-describedby="{{ localPosition }}Label"
  >
    {%- assign current_code = localization.language.iso_code | split: '-' | first | upcase -%}

    <div style="display: flex; gap: 10px; align-items: center;">
      {{- 'header-language.svg' | inline_asset_content -}}
      <div style="flex-shrink: 0; display: flex; align-items: center; gap: 5px;">
        <span>{{ current_code }}</span>
        <span class="collapse-icon">
          {% render 'icon-collapse' %}
        </span>
      </div>
    </div>
  </button>

  <div class="disclosure__list-wrapper language-selector" hidden>
    <ul
      id="{{ localPosition }}List"
      role="list"
      class="disclosure__list list-unstyled"
    >
      {%- for language in localization.available_languages -%}
        {%- assign option_code = language.iso_code | split: '-' | first | upcase -%}
        <li class="disclosure__item" tabindex="-1">
          <a
            class="link link--text disclosure__link caption-large focus-inset"
            href="#"
            hreflang="{{ language.iso_code }}"
            lang="{{ language.iso_code }}"
            {% if language.iso_code == localization.language.iso_code %}
              aria-current="true"
            {% endif %}
            data-value="{{ language.iso_code }}"
          >
            <span
              {% if language.iso_code != localization.language.iso_code %}
                class="visibility-hidden"
              {% endif %}
            >
              {{- 'icon-checkmark.svg' | inline_asset_content -}}
            </span>
            <span>{{ option_code }}</span>
          </a>
        </li>
      {%- endfor -%}
    </ul>
  </div>
</div>

<input
  type="hidden"
  name="locale_code"
  value="{{ localization.language.iso_code }}"
>
