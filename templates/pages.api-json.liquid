{%- layout none -%}

{
  "items": [
    {%- for link in linklists.pages-api.links -%}
      {%- if link.type == 'page' -%}
        {%- assign p = link.object -%}
        {
          "id": {{ p.id }},
          "title": {{ p.title | json }},
          "handle": {{ p.handle | json }},
          "url": {{ p.url | json }},
          "category": {{ p.metafields.page.category | default: '' | json }},
          "published_at": {{ p.published_at | date: "%Y-%m-%dT%H:%M:%S%:z" | json }},
          "updated_at": {{ p.updated_at | date: "%Y-%m-%dT%H:%M:%S%:z" | json }}
        }{% unless forloop.last %},{% endunless %}
      {%- endif -%}
    {%- endfor -%}
  ],
  "count": {{ linklists.pages-api.links | size }}
}
